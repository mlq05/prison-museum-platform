# 🚀 立即执行 - 数据库部署

## ⚡ 快速部署（3步完成）

### 第1步：获取腾讯云密钥（5分钟）

1. 访问：https://console.cloud.tencent.com/cam/capi
2. 如果没有密钥，点击 **"新建密钥"**
3. 复制 `SecretId` 和 `SecretKey`（SecretKey只在创建时显示一次，请妥善保管！）

---

### 第2步：配置环境变量（2分钟）

1. 登录：https://console.cloud.tencent.com/tcb
2. 选择环境：`prison-museum-dev-8e6hujc6eb768b`
3. 进入：**"云托管" → "服务管理" → "museum-api" → "环境变量"**
4. 添加以下环境变量：

```
变量名: TCB_ENV
变量值: prison-museum-dev-8e6hujc6eb768b

变量名: TCB_SECRET_ID
变量值: 你的SecretId

变量名: TCB_SECRET_KEY
变量值: 你的SecretKey
```

5. 点击 **"保存"**

---

### 第3步：重新部署服务器（3分钟）

1. 在同一个页面，点击 **"重新部署"** 或返回服务列表点击 **"部署新版本"**
2. 如果使用Git仓库部署：
   - 分支：`main`
   - 构建目录：`服务器`
3. 点击 **"开始部署"**
4. 等待部署完成（约2-5分钟）

---

## ✅ 验证部署

部署完成后：

1. 查看服务器日志：
   - 路径：**"云托管" → "服务管理" → "museum-api" → "日志"**
   - 应该看到：`云数据库初始化成功，环境ID: prison-museum-dev-8e6hujc6eb768b`

2. 测试健康检查：
   - 访问：`https://museum-api-xxx.sh.run.tcloudbase.com/health`
   - 应该返回正常响应

---

## 📝 可选操作

### 创建数据库集合（可选）

集合会在首次使用时自动创建，但可以提前创建：

1. 进入：**"数据库" → "数据集合"**
2. 点击 **"新建集合"**，创建：
   - `users`
   - `admins`
   - `bookings`
   - `halls`
   - `feedbacks`
   - `collections`
   - `certificates`
   - `visit_settings`
   - `ar_checkins`

---

## 🎉 完成！

数据库部署完成后，所有数据操作都会真正保存到云数据库。

**默认管理员账号**：
- 用户名：`zysfjgxy`
- 密码：`123456`

---

## 📚 详细文档

- 完整部署指南：`数据库部署指南.md`
- 操作清单：`数据库部署-操作清单.md`
- 数据库架构：`服务器/db/database-schema.md`

