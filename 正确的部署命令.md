# ✅ 正确的部署步骤

## 问题总结

你遇到的问题是：
1. ✅ 已安装 CloudBase CLI
2. ✅ 已登录
3. ❌ PowerShell 执行策略限制
4. ❌ CloudBase CLI 命令格式可能不对

## 🎯 最简单的方法：使用 CMD 和控制台上传

由于 CloudBase CLI 命令可能有版本差异，**推荐使用云开发控制台直接上传**：

### 步骤 1：准备文件

1. 打开文件资源管理器
2. 导航到 `F:\test4\服务器`
3. 使用 `打包-修复版.bat` 创建 ZIP 文件

或者手动创建一个 ZIP 包，包含以下文件（**不要包含 node_modules**）：
- server.js
- package.json
- package-lock.json
- Dockerfile
- .dockerignore
- cloudbaserc.json
- db/ 目录
- routes/ 目录
- middleware/ 目录
- scripts/ 目录

### 步骤 2：上传到云开发控制台

1. **登录云开发控制台**：
   - 访问：https://console.cloud.tencent.com/tcb
   - 选择环境：`test-7g8oe7lq75832d7c`

2. **进入云托管**：
   - 左侧菜单 → **"云托管"**
   - 点击 **"服务管理"**

3. **创建服务**（如果还没有）：
   - 点击 **"新建服务"**
   - 服务名称：`museum-api`
   - 点击 **"提交"**

4. **上传代码**：
   - 在服务详情页，点击 **"新建版本"**
   - 选择 **"本地上传"**
   - 选择你创建的 ZIP 文件（或使用 `打包-修复版.bat` 生成的 `server.zip`）
   - 点击 **"上传"**

5. **配置环境变量**：
   - 在版本配置中，找到 **"环境变量"**
   - 添加：
     ```
     NODE_ENV=production
     JWT_SECRET=你的随机密钥（至少32位字符）
     PORT=80
     ```

6. **部署**：
   - 点击 **"部署"**
   - 等待构建完成（约 2-5 分钟）

### 步骤 3：如果构建失败

如果 ZIP 上传后仍然构建失败，请：

1. **查看详细构建日志**：
   - 在云开发控制台 → 云托管 → 服务管理
   - 点击失败的版本
   - 查看 **"构建日志"**
   - 找到具体的错误信息

2. **或尝试 Git 仓库部署**：
   - 将代码推送到 GitHub/GitLab/码云
   - 在云开发控制台选择 **"Git 仓库"** 方式部署

---

## 或者：使用正确的 CLI 命令

如果你仍想使用 CLI，需要先查看正确的命令格式。在 CMD 中执行：

```cmd
cd /d F:\test4\服务器
cloudbase
```

这会显示所有可用命令。然后根据提示选择正确的部署命令。

---

## 📞 需要帮助？

请告诉我：
1. 你选择哪种方式（控制台上传 或 CLI）
2. 如果构建失败，请提供具体的错误信息

我会继续帮你解决问题！

