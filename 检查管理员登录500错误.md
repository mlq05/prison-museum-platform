# 🔍 检查管理员登录500错误

## 📋 当前状态

管理员登录接口返回 **500 错误**，错误消息：`登录失败,请稍后重试`

这说明：
- ✅ 代码已经部署（否则不会进入登录逻辑）
- ❌ 但在执行时发生了错误（可能是集合不存在或其他错误）

## 🔍 诊断步骤

### 步骤 1：查看服务器日志

1. **打开 CloudBase 控制台**
2. **进入服务日志**：
   - 左侧导航：**"云托管" → "服务管理" → "museum-api"**
   - 点击 **"日志"** 标签

3. **查看最近的错误日志**：
   - 查找包含 `管理员登录失败` 或 `Error:` 的日志
   - 查找包含 `admins` 或 `collection` 的错误信息
   - 查找 `DATABASE_COLLECTION_NOT_EXIST` 错误

4. **重点关注**：
   - 是否看到 `[ResourceNotFound] Db or Table not exist`？
   - 是否看到 `Cannot find module`？
   - 其他具体的错误信息

---

### 步骤 2：确认 `admins` 集合是否存在

1. **打开 CloudBase 控制台**
2. **进入文档型数据库**：
   - 左侧导航：**"数据库" → "数据集合"**

3. **检查集合列表**：
   - 是否能看到 `admins` 集合？
   - 如果看不到，需要创建（见步骤 3）

---

### 步骤 3：如果 `admins` 集合不存在，立即创建

1. **在文档型数据库页面**，点击 **"新建集合"**
2. **集合名称**：`admins`（全部小写）
3. **点击"确定"**

---

### 步骤 4：重启服务

创建 `admins` 集合后：

1. **在服务详情页面**，点击 **"重启"** 按钮
2. **等待 1-2 分钟**，让服务重新启动
3. **服务启动后会自动创建默认管理员账号**

---

## 🎯 可能的原因和解决方法

### 原因 1：`admins` 集合不存在

**症状**：
- 日志显示：`[ResourceNotFound] Db or Table not exist`
- 或：`DATABASE_COLLECTION_NOT_EXIST`

**解决方法**：
1. 创建 `admins` 集合（步骤 3）
2. 重启服务（步骤 4）

---

### 原因 2：默认管理员账号未创建

**症状**：
- 集合存在，但查询时返回 `null`
- 日志显示：`创建默认管理员失败`

**解决方法**：
1. 确认 `admins` 集合已创建
2. 重启服务，让系统自动创建默认管理员

---

### 原因 3：代码错误

**症状**：
- 日志显示具体的 JavaScript 错误
- 例如：`TypeError: Cannot read property...`

**解决方法**：
- 查看日志中的具体错误信息
- 告诉我错误详情，我会帮你修复

---

## 📝 需要你提供的信息

查看日志后，请告诉我：

1. **日志中的错误信息**：
   - 复制完整的错误日志（特别是包含 `Error:` 或 `失败` 的行）

2. **`admins` 集合是否存在**：
   - 是 / 否

3. **最新的服务器启动日志**：
   - 是否看到"默认管理员账号已创建"的消息？

---

## ✅ 快速修复步骤

如果确认是 `admins` 集合不存在：

1. ✅ **立即创建 `admins` 集合**
2. ✅ **重启服务**
3. ✅ **等待 1-2 分钟**
4. ✅ **再次测试登录**

现在就查看日志，告诉我你看到了什么错误信息！

