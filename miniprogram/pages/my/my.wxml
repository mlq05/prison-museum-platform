<!--my.wxml - 我的页面-->
<view class="my-page">
  <navigation-bar title="我的" show-back="{{false}}" />

  <!-- 用户信息卡片 -->
  <view class="user-card card" wx:if="{{isLoggedIn}}">
    <view class="user-header" bindtap="onEditProfile">
      <image class="user-avatar" src="{{userInfo.avatarUrl || '/assets/icons/default-avatar.png'}}" mode="aspectFill" />
      <view class="user-info">
        <view class="user-name">{{userInfo.name || userInfo.username || '未设置昵称'}}</view>
        <view class="user-role">{{userInfo.role === 'student' ? '学生' : userInfo.role === 'faculty' ? '教职工' : '访客'}}</view>
      </view>
      <view class="edit-icon">✎</view>
    </view>
    <view class="user-stats">
      <view class="stat-item">
        <view class="stat-value">{{statistics.bookingCount}}</view>
        <view class="stat-label">预约记录</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-value">{{statistics.collectionCount}}</view>
        <view class="stat-label">我的收藏</view>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <view class="stat-value">{{statistics.certificateCount}}</view>
        <view class="stat-label">我的证书</view>
      </view>
    </view>
  </view>

  <!-- 未登录状态 -->
  <view class="login-prompt card" wx:else>
    <view class="prompt-content">
      <image class="prompt-icon" src="/assets/icons/login.png" mode="aspectFit" />
      <view class="prompt-text">请登录以使用完整功能</view>
      <button class="btn btn-primary" bindtap="goToLogin">立即登录</button>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-item card" wx:for="{{menuItems}}" wx:key="id" data-path="{{item.path}}" bindtap="onMenuItemTap">
      <image class="menu-icon" src="{{item.icon}}" mode="aspectFit" />
      <view class="menu-content">
        <view class="menu-title">{{item.title}}</view>
      </view>
      <view class="menu-badge" wx:if="{{item.badge > 0}}">{{item.badge}}</view>
      <view class="menu-arrow">></view>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section" wx:if="{{isLoggedIn}}">
    <button class="btn btn-secondary" bindtap="onLogout">退出登录</button>
  </view>
</view>

