<!--admin-statistics.wxml-->
<view class="admin-statistics-page">
  <navigation-bar title="æ•°æ®ç»Ÿè®¡" />
  <scroll-view class="admin-statistics-scroll" scroll-y="true" enable-back-to-top="true">
    <!-- æ—¥æœŸèŒƒå›´é€‰æ‹© -->
    <view class="card">
      <view class="card-title">ç»Ÿè®¡æ—¶é—´èŒƒå›´</view>
      <view class="date-range">
        <view class="date-item">
          <text class="date-label">å¼€å§‹æ—¥æœŸ</text>
          <picker mode="date" value="{{dateRange.start}}" bindchange="onStartDateChange">
            <view class="date-picker">{{dateRange.start || 'è¯·é€‰æ‹©'}}</view>
          </picker>
        </view>
        <text class="date-separator">è‡³</text>
        <view class="date-item">
          <text class="date-label">ç»“æŸæ—¥æœŸ</text>
          <picker mode="date" value="{{dateRange.end}}" bindchange="onEndDateChange">
            <view class="date-picker">{{dateRange.end || 'è¯·é€‰æ‹©'}}</view>
          </picker>
        </view>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-container">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <block wx:if="{{!loading}}">
      <!-- æ€»ä½“ç»Ÿè®¡ -->
      <view class="card">
        <view class="card-title">æ€»ä½“ç»Ÿè®¡</view>
        <view class="stats-grid">
          <view class="stat-item">
            <view class="stat-value">{{statistics.totalBookings}}</view>
            <view class="stat-label">æ€»é¢„çº¦æ•°</view>
          </view>
          <view class="stat-item">
            <view class="stat-value stat-success">{{statistics.approvedBookings}}</view>
            <view class="stat-label">å·²é€šè¿‡</view>
          </view>
          <view class="stat-item">
            <view class="stat-value stat-warning">{{statistics.cancelledBookings}}</view>
            <view class="stat-label">å·²å–æ¶ˆ</view>
          </view>
          <view class="stat-item">
            <view class="stat-value stat-primary">{{statistics.totalVisitors}}</view>
            <view class="stat-label">æ€»å‚è§‚äººæ•°</view>
          </view>
        </view>
      </view>

      <!-- å–æ¶ˆç‡ -->
      <view class="card">
        <view class="card-title">å–æ¶ˆç‡</view>
        <view class="cancellation-rate">
          <view class="rate-value">{{statistics.cancellationRate}}%</view>
          <view class="rate-bar">
            <view class="rate-bar-fill" style="width: {{statistics.cancellationRate}}%"></view>
          </view>
        </view>
      </view>

      <!-- è§’è‰²åˆ†å¸ƒ -->
      <view class="card">
        <view class="card-title">è§’è‰²åˆ†å¸ƒ</view>
        <view class="role-list">
          <view class="role-item">
            <view class="role-info">
              <text class="role-icon">ğŸ“</text>
              <text class="role-name">å­¦ç”Ÿ</text>
            </view>
            <view class="role-count">{{statistics.roleDistribution.student}}</view>
          </view>
          <view class="role-item">
            <view class="role-info">
              <text class="role-icon">ğŸ‘”</text>
              <text class="role-name">æ•™èŒå·¥</text>
            </view>
            <view class="role-count">{{statistics.roleDistribution.faculty}}</view>
          </view>
          <view class="role-item">
            <view class="role-info">
              <text class="role-icon">ğŸ‘¤</text>
              <text class="role-name">è®¿å®¢</text>
            </view>
            <view class="role-count">{{statistics.roleDistribution.visitor}}</view>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view wx:if="{{statistics.totalBookings === 0}}" class="empty-state">
        <text class="empty-text">è¯¥æ—¶é—´æ®µå†…æš‚æ— é¢„çº¦æ•°æ®</text>
      </view>
    </block>
  </scroll-view>
</view>
